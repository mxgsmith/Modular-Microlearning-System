<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MicroLearn ‚Äî YouTube Advertiser-Friendly Guidelines</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0c0c0f;
    --surface: #14141a;
    --surface2: #1c1c26;
    --border: #2a2a38;
    --accent: #c8ff57;
    --accent2: #57c8ff;
    --accent3: #ff7a57;
    --text: #f0f0f5;
    --muted: #8080a0;
    --danger: #ff5757;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'DM Mono', monospace;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 9999;
    opacity: 0.4;
  }
  .shell {
    display: grid;
    grid-template-columns: 290px 1fr;
    grid-template-rows: 64px 1fr;
    min-height: 100vh;
  }
  .topbar {
    grid-column: 1 / -1;
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    padding: 0 28px;
    gap: 16px;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .logo { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.05rem; letter-spacing: -0.03em; flex-shrink: 0; }
  .logo span { color: var(--accent); }
  .topbar-divider { width: 1px; height: 28px; background: var(--border); }
  .topbar-course { flex: 1; font-size: 0.68rem; color: var(--muted); letter-spacing: 0.08em; text-transform: uppercase; }


  /* SIDEBAR */
  .sidebar { background: var(--surface); border-right: 1px solid var(--border); padding: 28px 0 28px; overflow-y: auto; display: flex; flex-direction: column; }
  .sidebar-label { font-size: 0.58rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--muted); padding: 0 24px 14px; }
  .arc-track { position: relative; padding: 0 24px; flex: 1; }
  .arc-line { position: absolute; left: 39px; top: 20px; width: 3px; background: var(--border); border-radius: 2px; bottom: 20px; }
  .arc-line-fill { position: absolute; left: 39px; top: 20px; width: 3px; background: linear-gradient(to bottom, var(--accent), var(--accent2)); border-radius: 2px; transition: height 0.7s cubic-bezier(0.16, 1, 0.3, 1); }

  /* Each lesson is multiple steps ‚Äî arc nodes represent individual steps */
  .arc-node { position: relative; display: flex; align-items: flex-start; gap: 14px; margin-bottom: 2px; cursor: pointer; padding: 4px 0; }
  .arc-dot { flex-shrink: 0; width: 30px; height: 30px; border-radius: 50%; border: 2px solid var(--border); background: var(--bg); display: flex; align-items: center; justify-content: center; font-size: 0.62rem; font-weight: 600; transition: all 0.3s ease; z-index: 1; position: relative; }
  .arc-node.done .arc-dot { background: var(--accent); border-color: var(--accent); color: #000; }
  .arc-node.active .arc-dot { background: var(--surface2); border-color: var(--accent2); color: var(--accent2); box-shadow: 0 0 0 4px rgba(87,200,255,0.12); }
  .arc-node.locked .arc-dot { opacity: 0.38; }
  .arc-info { padding: 5px 0 14px; }
  .arc-phase { font-size: 0.54rem; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); margin-bottom: 2px; }
  .arc-node.active .arc-phase { color: var(--accent2); }
  .arc-title { font-family: 'Syne', sans-serif; font-size: 0.8rem; font-weight: 600; color: var(--text); line-height: 1.3; }
  .arc-node.locked .arc-title { color: var(--muted); }
  .arc-node.active .arc-title { color: #fff; }
  .arc-duration { font-size: 0.58rem; color: var(--muted); margin-top: 2px; }

  .phase-header { padding: 16px 0 8px; margin-left: 44px; }
  .phase-header:first-child { padding-top: 0; }
  .phase-pill { font-size: 0.54rem; letter-spacing: 0.12em; text-transform: uppercase; padding: 3px 10px; border-radius: 20px; font-weight: 700; }
  .phase-pill.ignite { background: rgba(200,255,87,0.12); color: var(--accent); }
  .phase-pill.build { background: rgba(87,200,255,0.12); color: var(--accent2); }
  .phase-pill.apply { background: rgba(255,122,87,0.12); color: var(--accent3); }
  .phase-pill.master { background: rgba(255,87,87,0.1); color: var(--danger); }

  /* MODULE SECTION HEADERS IN SIDEBAR */
  .module-sep { padding: 20px 24px 10px; border-top: 1px solid var(--border); margin-top: 8px; }
  .module-sep:first-of-type { border-top: none; margin-top: 0; padding-top: 0; }
  .module-sep-label { font-size: 0.58rem; letter-spacing: 0.14em; text-transform: uppercase; color: var(--muted); margin-bottom: 2px; }
  .module-sep-title { font-family: 'Syne', sans-serif; font-size: 0.78rem; font-weight: 700; color: var(--text); }

  /* MASTERY */
  .mastery-section { display: flex; align-items: center; gap: 12px; padding: 14px 20px; background: var(--surface2); border: 1px solid var(--border); border-radius: 12px; margin: 20px 24px 0; }
  .mastery-label { font-size: 0.6rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); flex-shrink: 0; }
  .mastery-bar-track { flex: 1; height: 6px; background: var(--border); border-radius: 4px; overflow: hidden; }
  .mastery-bar-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent2), var(--accent)); border-radius: 4px; transition: width 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
  .mastery-pct { font-family: 'Syne', sans-serif; font-size: 0.78rem; font-weight: 700; color: var(--accent); flex-shrink: 0; }

  /* MAIN */
  .main { display: flex; flex-direction: column; overflow: hidden; }
  .progress-track { height: 3px; background: var(--border); flex-shrink: 0; }
  .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2)); transition: width 0.5s ease; box-shadow: 0 0 12px rgba(200,255,87,0.35); }

  .content { flex: 1; overflow-y: auto; padding: 44px 60px 20px; }
  .content-inner { max-width: 680px; margin: 0 auto; }

  /* STEP INDICATOR */
  .step-indicator {
    display: flex; gap: 6px; margin-bottom: 28px; align-items: center;
  }
  .step-dot {
    width: 8px; height: 8px; border-radius: 50%; background: var(--border); transition: all 0.3s;
  }
  .step-dot.done { background: var(--accent); }
  .step-dot.active { background: var(--accent2); box-shadow: 0 0 0 3px rgba(87,200,255,0.2); }

  /* PHASE STAMP */
  .phase-stamp { display: inline-flex; align-items: center; gap: 8px; font-size: 0.58rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--accent2); margin-bottom: 14px; padding: 5px 13px; background: rgba(87,200,255,0.08); border: 1px solid rgba(87,200,255,0.2); border-radius: 20px; }
  .phase-stamp::before { content: ''; width: 6px; height: 6px; border-radius: 50%; background: var(--accent2); animation: pulse 2s ease-in-out infinite; }
  @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.4; transform: scale(0.75); } }

  .lesson-meta { display: flex; align-items: center; gap: 14px; margin-bottom: 10px; }
  .lesson-number { font-family: 'Syne', sans-serif; font-size: 0.62rem; color: var(--muted); letter-spacing: 0.1em; }
  .lesson-time { font-size: 0.62rem; color: var(--muted); }

  h1 { font-family: 'Syne', sans-serif; font-size: 2.2rem; font-weight: 800; line-height: 1.1; letter-spacing: -0.03em; margin-bottom: 10px; }
  .subtitle { font-size: 0.83rem; color: var(--muted); line-height: 1.7; margin-bottom: 36px; max-width: 560px; }

  .objective-card { background: linear-gradient(135deg, rgba(200,255,87,0.06), rgba(87,200,255,0.06)); border: 1px solid rgba(200,255,87,0.15); border-radius: 14px; padding: 22px; margin-bottom: 32px; }
  .objective-card-label { font-size: 0.58rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--accent); margin-bottom: 8px; }
  .objective-text { font-family: 'Syne', sans-serif; font-size: 0.95rem; font-weight: 600; line-height: 1.5; color: #fff; }

  .block { margin-bottom: 30px; }
  .block-label { font-size: 0.58rem; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
  .block-label::after { content: ''; flex: 1; height: 1px; background: var(--border); }
  .body-text { font-size: 0.83rem; line-height: 1.9; color: #c0c0d8; }
  .highlight { background: rgba(200,255,87,0.1); color: var(--accent); padding: 1px 6px; border-radius: 4px; font-style: italic; }
  .hl2 { background: rgba(87,200,255,0.1); color: var(--accent2); padding: 1px 6px; border-radius: 4px; }
  .hl3 { background: rgba(255,122,87,0.1); color: var(--accent3); padding: 1px 6px; border-radius: 4px; }

  /* TIER TABLE */
  .tier-table { width: 100%; border-collapse: collapse; margin-top: 14px; font-size: 0.78rem; }
  .tier-table th { text-align: left; padding: 10px 14px; font-size: 0.58rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); border-bottom: 1px solid var(--border); font-weight: 400; }
  .tier-table td { padding: 12px 14px; border-bottom: 1px solid rgba(42,42,56,0.5); line-height: 1.6; color: #c0c0d8; vertical-align: top; }
  .tier-table tr:last-child td { border-bottom: none; }
  .tier-badge { display: inline-flex; align-items: center; gap: 6px; font-size: 0.62rem; font-weight: 700; font-family: 'Syne', sans-serif; padding: 3px 10px; border-radius: 20px; white-space: nowrap; }
  .tier-badge.green { background: rgba(200,255,87,0.12); color: var(--accent); }
  .tier-badge.yellow { background: rgba(255,200,57,0.12); color: #ffc839; }
  .tier-badge.red { background: rgba(255,87,87,0.12); color: var(--danger); }

  /* CONCEPT GRID */
  .concept-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; }
  .concept-card { background: var(--surface2); border: 1px solid var(--border); border-radius: 12px; padding: 18px; transition: all 0.25s ease; position: relative; overflow: hidden; }
  .concept-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, var(--accent), var(--accent2)); opacity: 0; transition: opacity 0.25s; }
  .concept-card:hover { border-color: rgba(200,255,87,0.25); transform: translateY(-2px); }
  .concept-card:hover::before { opacity: 1; }
  .concept-icon { font-size: 1.4rem; margin-bottom: 8px; }
  .concept-title { font-family: 'Syne', sans-serif; font-size: 0.82rem; font-weight: 700; margin-bottom: 5px; }
  .concept-desc { font-size: 0.7rem; color: var(--muted); line-height: 1.6; }

  /* CALLOUT */
  .callout { border-left: 3px solid var(--accent3); padding: 14px 18px; background: rgba(255,122,87,0.06); border-radius: 0 10px 10px 0; margin: 20px 0; }
  .callout-text { font-family: 'Syne', sans-serif; font-size: 0.88rem; font-style: italic; line-height: 1.6; color: #e0d0c8; }

  /* EXAMPLE LIST */
  .example-list { list-style: none; display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }
  .example-list li { display: flex; gap: 10px; font-size: 0.78rem; line-height: 1.6; color: #c0c0d8; padding: 10px 14px; background: var(--surface2); border-radius: 8px; border: 1px solid var(--border); }
  .example-list li::before { content: attr(data-icon); flex-shrink: 0; }

  /* QUIZ */
  .quiz-section { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 26px; margin-top: 32px; }
  .quiz-header { display: flex; align-items: center; gap: 10px; margin-bottom: 18px; }
  .quiz-badge { font-size: 0.58rem; letter-spacing: 0.12em; text-transform: uppercase; background: rgba(255,122,87,0.15); color: var(--accent3); padding: 4px 10px; border-radius: 20px; border: 1px solid rgba(255,122,87,0.25); }
  .quiz-q { font-family: 'Syne', sans-serif; font-size: 0.92rem; font-weight: 600; margin-bottom: 16px; line-height: 1.45; }
  .quiz-options { display: flex; flex-direction: column; gap: 9px; }
  .quiz-opt { display: flex; align-items: flex-start; gap: 12px; padding: 13px 16px; background: var(--surface2); border: 1px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; font-size: 0.78rem; line-height: 1.5; }
  .quiz-opt:hover { border-color: rgba(87,200,255,0.35); background: rgba(87,200,255,0.04); }
  .quiz-opt.selected { border-color: var(--accent2); background: rgba(87,200,255,0.08); }
  .quiz-opt.correct { border-color: var(--accent); background: rgba(200,255,87,0.07); color: var(--accent); }
  .quiz-opt.wrong { border-color: var(--danger); background: rgba(255,87,87,0.07); color: var(--danger); }
  .opt-key { min-width: 22px; height: 22px; border-radius: 6px; border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 0.62rem; flex-shrink: 0; font-weight: 600; margin-top: 1px; }
  .quiz-feedback { margin-top: 14px; padding: 12px 16px; border-radius: 10px; font-size: 0.78rem; line-height: 1.6; display: none; }
  .quiz-feedback.show { display: block; }
  .quiz-feedback.correct-fb { background: rgba(200,255,87,0.07); border: 1px solid rgba(200,255,87,0.2); color: var(--accent); }
  .quiz-feedback.wrong-fb { background: rgba(255,87,87,0.06); border: 1px solid rgba(255,87,87,0.2); color: #ff8888; }

  /* BOTTOM NAV */
  .bottom-nav { border-top: 1px solid var(--border); padding: 18px 60px; display: flex; align-items: center; justify-content: space-between; background: var(--bg); flex-shrink: 0; }
  .nav-step-info { font-size: 0.68rem; color: var(--muted); }
  .nav-step-info strong { color: var(--text); font-family: 'Syne', sans-serif; }
  .btn { font-family: 'Syne', sans-serif; font-size: 0.76rem; font-weight: 700; letter-spacing: 0.05em; padding: 11px 24px; border-radius: 10px; border: none; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 7px; }
  .btn-primary { background: var(--accent); color: #000; }
  .btn-primary:hover { background: #d4ff6a; transform: translateY(-1px); box-shadow: 0 6px 20px rgba(200,255,87,0.22); }
  .btn-primary:disabled { opacity: 0.35; pointer-events: none; }
  .btn-ghost { background: transparent; color: var(--muted); border: 1px solid var(--border); }
  .btn-ghost:hover { color: var(--text); border-color: rgba(255,255,255,0.2); }
  .btn-ghost:disabled { opacity: 0.25; pointer-events: none; }
  .btn-group { display: flex; gap: 10px; }

  /* COMPLETION CARD */
  .completion-card { text-align: center; padding: 60px 40px; }
  .completion-icon { font-size: 4rem; margin-bottom: 20px; }
  .completion-title { font-family: 'Syne', sans-serif; font-size: 2rem; font-weight: 800; letter-spacing: -0.03em; margin-bottom: 12px; background: linear-gradient(135deg, var(--accent), var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
  .completion-sub { font-size: 0.85rem; color: var(--muted); line-height: 1.7; max-width: 440px; margin: 0 auto; }
  .xp-earned { display: inline-flex; align-items: center; gap: 10px; background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 14px 24px; margin-top: 28px; font-family: 'Syne', sans-serif; font-size: 1.1rem; font-weight: 800; color: var(--accent); }

  /* SLIDE ANIMATION */
  @keyframes slideIn { from { opacity: 0; transform: translateX(24px); } to { opacity: 1; transform: none; } }
  @keyframes slideInLeft { from { opacity: 0; transform: translateX(-24px); } to { opacity: 1; transform: none; } }
  .slide-in { animation: slideIn 0.38s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
  .slide-in-left { animation: slideInLeft 0.38s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
</style>
</head>
<body>
<div class="shell">
  <!-- TOPBAR -->
  <header class="topbar">
    <div class="logo">micro<span>learn</span></div>
    <div class="topbar-divider"></div>
    <div class="topbar-course" id="topbarCourse">YouTube Advertiser-Friendly Guidelines</div>

  </header>

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-label">Learning Arc ‚Äî 3 Modules</div>
    <div class="arc-track">
      <div class="arc-line"></div>
      <div class="arc-line-fill" id="arcFill" style="height:0%"></div>

      <!-- MODULE 1: Inappropriate Language -->
      <div style="position:relative; z-index:1;">
        <div class="phase-header"><span class="phase-pill ignite">Module 1</span></div>
        <div class="arc-node" id="node-0-0" onclick="jumpTo(0,0)">
          <div class="arc-dot" id="dot-0-0">1</div>
          <div class="arc-info">
            <div class="arc-phase">Ignite</div>
            <div class="arc-title">Language Rules Overview</div>
            <div class="arc-duration">‚è± 2 min</div>
          </div>
        </div>
        <div class="arc-node" id="node-0-1" onclick="jumpTo(0,1)">
          <div class="arc-dot" id="dot-0-1">2</div>
          <div class="arc-info">
            <div class="arc-phase">Build</div>
            <div class="arc-title">Three Tiers Explained</div>
            <div class="arc-duration">‚è± 3 min</div>
          </div>
        </div>
        <div class="arc-node" id="node-0-2" onclick="jumpTo(0,2)">
          <div class="arc-dot" id="dot-0-2">3</div>
          <div class="arc-info">
            <div class="arc-phase">Apply</div>
            <div class="arc-title">Quick Check</div>
            <div class="arc-duration">‚è± 1 min</div>
          </div>
        </div>

        <!-- MODULE 2: Violence -->
        <div class="phase-header" style="margin-top:8px;"><span class="phase-pill build">Module 2</span></div>
        <div class="arc-node" id="node-1-0" onclick="jumpTo(1,0)">
          <div class="arc-dot" id="dot-1-0">4</div>
          <div class="arc-info">
            <div class="arc-phase">Ignite</div>
            <div class="arc-title">Violence Policy Overview</div>
            <div class="arc-duration">‚è± 2 min</div>
          </div>
        </div>
        <div class="arc-node" id="node-1-1" onclick="jumpTo(1,1)">
          <div class="arc-dot" id="dot-1-1">5</div>
          <div class="arc-info">
            <div class="arc-phase">Build</div>
            <div class="arc-title">Context Is Everything</div>
            <div class="arc-duration">‚è± 3 min</div>
          </div>
        </div>
        <div class="arc-node" id="node-1-2" onclick="jumpTo(1,2)">
          <div class="arc-dot" id="dot-1-2">6</div>
          <div class="arc-info">
            <div class="arc-phase">Apply</div>
            <div class="arc-title">Quick Check</div>
            <div class="arc-duration">‚è± 1 min</div>
          </div>
        </div>

        <!-- MODULE 3: Hateful Content -->
        <div class="phase-header" style="margin-top:8px;"><span class="phase-pill master">Module 3</span></div>
        <div class="arc-node" id="node-2-0" onclick="jumpTo(2,0)">
          <div class="arc-dot" id="dot-2-0">7</div>
          <div class="arc-info">
            <div class="arc-phase">Ignite</div>
            <div class="arc-title">Hateful Content Overview</div>
            <div class="arc-duration">‚è± 2 min</div>
          </div>
        </div>
        <div class="arc-node" id="node-2-1" onclick="jumpTo(2,1)">
          <div class="arc-dot" id="dot-2-1">8</div>
          <div class="arc-info">
            <div class="arc-phase">Build</div>
            <div class="arc-title">Protected Groups & Satire</div>
            <div class="arc-duration">‚è± 3 min</div>
          </div>
        </div>
        <div class="arc-node" id="node-2-2" onclick="jumpTo(2,2)">
          <div class="arc-dot" id="dot-2-2">9</div>
          <div class="arc-info">
            <div class="arc-phase">Master</div>
            <div class="arc-title">Final Challenge</div>
            <div class="arc-duration">‚è± 2 min</div>
          </div>
        </div>
      </div>
    </div>

    <div class="mastery-section">
      <span class="mastery-label">Mastery</span>
      <div class="mastery-bar-track"><div class="mastery-bar-fill" id="masteryBar"></div></div>
      <span class="mastery-pct" id="masteryPct">0%</span>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
    <div class="content" id="lessonContent"></div>
    <div class="bottom-nav">
      <div class="nav-step-info" id="navInfo"></div>
      <div class="btn-group">
        <button class="btn btn-ghost" id="btnPrev" onclick="navigate(-1)">‚Üê Back</button>
        <button class="btn btn-primary" id="btnNext" onclick="navigate(1)">Continue ‚Üí</button>
      </div>
    </div>
  </main>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ CURRICULUM DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const CURRICULUM = [
  // MODULE 0: Inappropriate Language
  [
    // Step 0: Ignite
    {
      phase: 'Ignite ¬∑ Module 1 of 3',
      module: 'MODULE 1',
      time: '2 min read',
      title: 'Inappropriate Language',
      subtitle: 'What you say ‚Äî and how you say it ‚Äî determines whether your YouTube content can earn ad revenue.',
      objective: 'Understand how YouTube categorizes profanity and language across three monetization tiers, and know when context changes the outcome.',
      quiz: null,
      blocks: [
        {
          label: 'Why Language Matters',
          body: `YouTube's Advertiser-Friendly Content Guidelines govern which videos can share ad revenue through the YouTube Partner Program. Language is one of the most frequently flagged categories because it's easy to overlook ‚Äî a single word in a thumbnail or title can change your monetization status entirely.\n\nThe golden rule: it's not just <span class="highlight">what</span> you say, but <span class="hl2">where</span> you say it and <span class="hl3">how often</span>.`,
          type: 'text'
        },
        {
          label: 'Two Key Definitions',
          body: null,
          type: 'concepts',
          items: [
            { icon: 'üîá', title: 'Obscured Profanity', desc: 'Bleeping, muting, or adding symbols over written words. WTF counts as "abbreviated" ‚Äî the original term is implied via acronym.' },
            { icon: 'üìç', title: 'Focal Use', desc: 'When profanity appears in most sentences throughout a video. This is different from occasional swearing, which is treated more leniently.' },
            { icon: 'üéµ', title: 'Music Exception', desc: 'Most profanity in music or stand-up comedy content is treated differently ‚Äî context gives creators more leeway.' },
            { icon: 'üñºÔ∏è', title: 'Title & Thumbnail', desc: 'Rules are stricter here. The same word that\'s fine in a video may result in "limited or no ads" if placed in a title or thumbnail.' },
          ]
        },
        {
          label: 'The Core Insight',
          body: null,
          type: 'callout',
          text: '"Context is everything. The same word in a music video chorus, a documentary voiceover, and a video title will each receive a different monetization outcome."'
        }
      ]
    },
    // Step 1: Build
    {
      phase: 'Build ¬∑ Module 1 of 3',
      module: 'MODULE 1',
      time: '3 min read',
      title: 'The Three-Tier System',
      subtitle: 'YouTube assigns one of three monetization states to each video. Knowing the tiers helps you self-certify accurately.',
      objective: 'Classify real content examples into the correct monetization tier based on language type, placement, and frequency.',
      quiz: null,
      blocks: [
        {
          label: 'Monetization Tiers',
          body: null,
          type: 'tiers',
          rows: [
            {
              badge: { label: '‚úì Full Ads', cls: 'green' },
              content: 'Abbreviated or obscured profanity. Moderate words like "shit" or "bitch" used frequently in the video (not in title/thumbnail). Most profanity within music or stand-up comedy.'
            },
            {
              badge: { label: '‚ö† Limited Ads', cls: 'yellow' },
              content: 'Moderate profanity like "shit" in the title or thumbnail. Focal use of profanity throughout a video (used in most sentences). Profanity in the title/thumbnail of music or comedy content.'
            },
            {
              badge: { label: '‚úï No Ads', cls: 'red' },
              content: 'Strong profanity (e.g. f*ck) in thumbnails or titles. Any use of extreme profanity ‚Äî hateful slurs ‚Äî anywhere in the video, thumbnail, or title.'
            }
          ]
        },
        {
          label: 'Real-World Examples',
          body: null,
          type: 'examples',
          items: [
            { icon: '‚úÖ', text: 'A gaming video where a creator occasionally says "shit" during gameplay ‚Äî earns full ads.' },
            { icon: '‚úÖ', text: 'A music video where the uncensored lyrics include moderate profanity ‚Äî earns full ads.' },
            { icon: '‚ö†Ô∏è', text: 'A vlog titled "This Day Was Total Sh*t" ‚Äî limited or no ads due to placement in title.' },
            { icon: '‚ùå', text: 'Any video using racial or other hateful slurs anywhere ‚Äî earns no ad revenue, full stop.' },
          ]
        },
        {
          label: 'Pro Tip',
          body: `When self-certifying in YouTube Studio, ask yourself: <span class="highlight">where is the word?</span> (title vs. video), <span class="hl2">how strong is it?</span> (mild vs. extreme), and <span class="hl3">how often does it appear?</span> (occasional vs. focal). These three questions map directly to YouTube's tiers.`,
          type: 'text'
        }
      ]
    },
    // Step 2: Quick Check
    {
      phase: 'Apply ¬∑ Module 1 of 3',
      module: 'MODULE 1',
      time: '1 min',
      title: 'Quick Check',
      subtitle: 'Test what you learned about YouTube\'s language policy before moving on.',
      objective: null,
      quiz: {
        question: 'A creator uploads a gaming video where they say "shit" several times throughout, but it never appears in the title or thumbnail. What monetization outcome should they expect?',
        options: [
          { text: 'No ad revenue ‚Äî any use of "shit" disqualifies a video.', correct: false },
          { text: 'Full ad revenue ‚Äî moderate profanity used frequently in the video body is generally allowed.', correct: true },
          { text: 'Limited ad revenue ‚Äî all profanity results in reduced monetization regardless of context.', correct: false },
          { text: 'It depends entirely on the game being played, not the language.', correct: false }
        ],
        correctFeedback: '‚úì Correct! Moderate profanity like "shit" used throughout a video (but not in the title or thumbnail) falls under the "can earn ad revenue" tier. Placement and context make all the difference.',
        wrongFeedback: '‚úó Not quite. YouTube\'s guidelines specifically allow moderate profanity like "shit" in video content ‚Äî it only becomes a problem in titles, thumbnails, or when hateful slurs are involved.'
      },
      blocks: []
    }
  ],

  // MODULE 1: Violence
  [
    // Step 0: Ignite
    {
      phase: 'Ignite ¬∑ Module 2 of 3',
      module: 'MODULE 2',
      time: '2 min read',
      title: 'Violence Policy',
      subtitle: 'Not all violent content is treated equally. YouTube\'s approach hinges on focal intent, context, and graphic detail.',
      objective: 'Understand the foundational principle behind YouTube\'s violence policy: context determines monetizability, not violence alone.',
      quiz: null,
      blocks: [
        {
          label: 'The Core Principle',
          body: `Content where the <span class="highlight">focal point is blood, violence, or injury</span> ‚Äî presented without context ‚Äî is not suitable for advertising. But violence shown in a <span class="hl2">news, educational, artistic, or documentary context</span> is treated differently and may still be fully monetizable.\n\nThis means a war documentary and a gore compilation can contain similar footage but receive completely different monetization outcomes.`,
          type: 'text'
        },
        {
          label: 'What "Focal" Means',
          body: null,
          type: 'callout',
          text: '"Focal" means the video\'s primary subject is violent content. A passing reference to violence in a larger narrative is very different from a video centered around it.'
        },
        {
          label: 'Key Concepts',
          body: null,
          type: 'concepts',
          items: [
            { icon: 'üéÆ', title: 'Gaming Exception', desc: 'Unedited gameplay violence is generally acceptable. But montages where gratuitous violence is the focal point are not ‚Äî regardless of whether the game is realistic or fictional.' },
            { icon: 'üì∞', title: 'News & Documentary', desc: 'Journalistic coverage of violent events (like terrorist attacks) may be fully monetizable when the context is clearly educational or informational.' },
            { icon: 'ü©∏', title: 'First 15 Seconds', desc: 'Graphic game violence in the first 8‚Äì15 seconds of a video receives stricter treatment than the same content appearing later.' },
            { icon: 'üêæ', title: 'Animal Content', desc: 'Nature footage of predators and prey with minimal graphic detail is acceptable. Focal prolonged graphic animal injuries, or human-caused animal abuse, are not.' },
          ]
        }
      ]
    },
    // Step 1: Build
    {
      phase: 'Build ¬∑ Module 2 of 3',
      module: 'MODULE 2',
      time: '3 min read',
      title: 'Context Is Everything',
      subtitle: 'The same footage can earn full ads or no ads depending on how it\'s framed. Let\'s break down the tiers.',
      objective: 'Apply the three-tier framework to violence scenarios across gaming, news, sports, and documentary content.',
      quiz: null,
      blocks: [
        {
          label: 'Monetization Tiers',
          body: null,
          type: 'tiers',
          rows: [
            {
              badge: { label: '‚úì Full Ads', cls: 'green' },
              content: 'Mild violence with minimal blood. Unedited gameplay violence after the first 15 seconds. Law enforcement in action (arrests, crowd control). Educational/journalistic coverage of violent events. Non-graphic dead bodies in historical/educational context.'
            },
            {
              badge: { label: '‚ö† Limited Ads', cls: 'yellow' },
              content: 'Dead bodies with obvious injury in educational/documentary settings. Graphic game violence in thumbnails or early in the video. Raw footage of armed conflict without injuries shown. Highly combative altercations with law enforcement. Graphic sports injuries as part of a larger video.'
            },
            {
              badge: { label: '‚úï No Ads', cls: 'red' },
              content: 'Focus on blood, guts, or gore with little to no context. Ultra-graphic violent acts. Incitement or glorification of violence. Graphic footage of war injury, death, or suffering. Video gameplay showing sexual violence, hate-motivated violence, or graphic torture.'
            }
          ]
        },
        {
          label: 'Side-by-Side Comparison',
          body: null,
          type: 'examples',
          items: [
            { icon: '‚úÖ', text: 'News report on a terrorist attack with journalistic framing and no graphic imagery ‚Üí Full ads.' },
            { icon: '‚úÖ', text: 'Gaming video where a character is defeated graphically ‚Äî but after the 15-second mark ‚Üí Full ads.' },
            { icon: '‚ö†Ô∏è', text: 'Documentary on a historical massacre that includes non-graphic dead bodies ‚Üí Limited ads.' },
            { icon: '‚ùå', text: 'Compilation video focused solely on "best knockouts" from street fights with injuries shown ‚Üí No ads.' },
          ]
        },
        {
          label: 'Remember',
          body: `The framing question to ask yourself: <span class="highlight">Is violence the point of my video, or does it appear within a larger context?</span> If your video could be subtitled "watch people get hurt," it's likely to receive limited or no ads.`,
          type: 'text'
        }
      ]
    },
    // Step 2: Quick Check
    {
      phase: 'Apply ¬∑ Module 2 of 3',
      module: 'MODULE 2',
      time: '1 min',
      title: 'Quick Check',
      subtitle: 'Apply what you\'ve learned about YouTube\'s violence policy.',
      objective: null,
      quiz: {
        question: 'A gaming channel uploads a "Top 10 Best Kills" montage where each clip starts with the graphic kill animation. The montage begins in the first 10 seconds. What outcome should the creator expect?',
        options: [
          { text: 'Full ad revenue ‚Äî gaming content is always allowed regardless of graphic content.', correct: false },
          { text: 'Full ad revenue ‚Äî montages are treated the same as regular gameplay.', correct: false },
          { text: 'Limited or no ad revenue ‚Äî gratuitous violence montages are not allowed, especially with graphic content appearing early.', correct: true },
          { text: 'Full ad revenue ‚Äî only real-world violence is restricted, not gaming.', correct: false }
        ],
        correctFeedback: '‚úì Correct! YouTube distinguishes between unedited gameplay (acceptable) and montages where gratuitous violence is the focal point (not acceptable). Graphic game violence in the first 8‚Äì15 seconds also triggers stricter treatment.',
        wrongFeedback: '‚úó Not quite. Gaming content is not exempt ‚Äî YouTube specifically states that montages where gratuitous violence is the focal point are not suitable for advertising, regardless of whether the game is realistic or fictional.'
      },
      blocks: []
    }
  ],

  // MODULE 2: Hateful & Derogatory
  [
    // Step 0: Ignite
    {
      phase: 'Ignite ¬∑ Module 3 of 3',
      module: 'MODULE 3',
      time: '2 min read',
      title: 'Hateful & Derogatory Content',
      subtitle: 'Content that incites hatred, promotes discrimination, or humiliates protected groups is not suitable for advertising ‚Äî with important nuances for satire and education.',
      objective: 'Identify the protected characteristics under YouTube\'s hateful content policy and understand when satire or education creates exceptions.',
      quiz: null,
      blocks: [
        {
          label: 'The Core Rule',
          body: `Content that <span class="highlight">incites hatred against, promotes discrimination of, disparages, or humiliates</span> an individual or group based on a protected characteristic is not advertiser-friendly. YouTube explicitly notes that stating "comedic intent" is not sufficient to exempt content.`,
          type: 'text'
        },
        {
          label: 'Protected Characteristics',
          body: null,
          type: 'concepts',
          items: [
            { icon: 'üåç', title: 'Identity', desc: 'Race, ethnicity or ethnic origin, nationality, religion.' },
            { icon: '‚ôø', title: 'Status', desc: 'Disability, age, veteran status.' },
            { icon: 'üè≥Ô∏è‚Äçüåà', title: 'Orientation & Identity', desc: 'Sexual orientation, gender identity.' },
            { icon: '‚öñÔ∏è', title: 'Broader Protections', desc: 'Any characteristic associated with systemic discrimination or marginalization.' },
          ]
        },
        {
          label: 'The Satire Nuance',
          body: null,
          type: 'callout',
          text: '"Content that is satire or comedy may be exempt ‚Äî but you cannot simply claim comedic intent. The content itself must clearly condemn or alludes to ridicule of hateful behavior, not reinforce it."'
        }
      ]
    },
    // Step 1: Build
    {
      phase: 'Build ¬∑ Module 3 of 3',
      module: 'MODULE 3',
      time: '3 min read',
      title: 'Protected Groups & Satire',
      subtitle: 'Where is the line between commentary, education, satire ‚Äî and content that genuinely incites hate?',
      objective: 'Distinguish between content that criticizes opinions vs. content that disparages identity, and understand how educational use of slurs is treated.',
      quiz: null,
      blocks: [
        {
          label: 'Monetization Tiers',
          body: null,
          type: 'tiers',
          rows: [
            {
              badge: { label: '‚úì Full Ads', cls: 'green' },
              content: 'News content describing a protected group in a non-hateful way. Comedic content that condemns hateful attitudes. Public debate on protected groups without inciting violence. Educational content with obscured slurs (e.g. "n***er"). Criticizing an individual\'s opinions or actions without demeaning intent.'
            },
            {
              badge: { label: '‚ö† Limited Ads', cls: 'yellow' },
              content: 'Educational content with unobscured slurs or derogatory terms. Content that may offend but is used for education or documentary purposes. Raw footage featuring acts of shaming or insulting without glorifying them.'
            },
            {
              badge: { label: '‚úï No Ads', cls: 'red' },
              content: 'Statements implying inferiority of a protected group. Non-educational content using racial slurs. Promoting or glorifying hate groups or hate symbols. Malicious shaming, singling someone out for harassment. Denying tragic events or framing victims as actors. Personal attacks, slander, and defamation.'
            }
          ]
        },
        {
          label: 'Critical Distinctions',
          body: null,
          type: 'examples',
          items: [
            { icon: '‚úÖ', text: 'A video critiquing a politician\'s voting record on civil rights ‚Äî criticizing opinions, not identity ‚Üí Full ads.' },
            { icon: '‚úÖ', text: 'A documentary on the history of racism that uses slurs in an obscured/bleeped form with educational intent ‚Üí Full ads.' },
            { icon: '‚ö†Ô∏è', text: 'An educational video that spells out slurs in full while discussing their history ‚Üí Limited ads.' },
            { icon: '‚ùå', text: 'A video saying "all people from [country] are disgusting" ‚Äî disparages a group based on nationality ‚Üí No ads.' },
          ]
        },
        {
          label: 'The Opinion vs. Identity Test',
          body: `Always ask: am I criticizing what someone <span class="highlight">believes or does</span>, or am I attacking what someone <span class="hl3">is</span>? Criticizing ideology, policy, or behavior is generally allowed. Attacking identity ‚Äî race, gender, religion, disability ‚Äî is not.`,
          type: 'text'
        }
      ]
    },
    // Step 2: Final Challenge
    {
      phase: 'Master ¬∑ Module 3 of 3',
      module: 'MODULE 3',
      time: '2 min',
      title: 'Final Challenge',
      subtitle: 'You\'ve covered all three policies. Now let\'s see if you can apply them together.',
      objective: null,
      quiz: {
        question: 'A creator uploads a documentary about hate crimes that includes unobscured racial slurs in quoted testimony from victims, with full historical and educational context. What should they expect?',
        options: [
          { text: 'Full ad revenue ‚Äî documentaries are always exempt from language restrictions.', correct: false },
          { text: 'No ad revenue ‚Äî racial slurs in any form always result in demonetization.', correct: false },
          { text: 'Limited or no ad revenue ‚Äî unobscured slurs in educational content can earn limited ads, but not full ads.', correct: true },
          { text: 'Full ad revenue ‚Äî the victim testimony context makes slurs fully acceptable.', correct: false }
        ],
        correctFeedback: '‚úì Excellent! YouTube distinguishes between obscured slurs (can earn full ads) and unobscured/fully-spelled-out slurs (limited ads), even in educational contexts. The intent matters, but the form of the slur also affects the outcome.',
        wrongFeedback: '‚úó Not quite. YouTube\'s guidelines draw a specific line between obscured slurs (full ads possible) and unobscured slurs in educational content (limited ads). Neither blanket exemptions nor blanket bans apply to documentary content.'
      },
      blocks: []
    }
  ]
];

// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let currentModule = 0;
let currentStep = 0;
let answeredSteps = new Set();
let direction = 1; // 1 = forward, -1 = back

const TOTAL_STEPS = CURRICULUM.reduce((a, m) => a + m.length, 0);

function flatIndex(mod, step) {
  let idx = 0;
  for (let m = 0; m < mod; m++) idx += CURRICULUM[m].length;
  return idx + step;
}

function fromFlat(flat) {
  let idx = flat;
  for (let m = 0; m < CURRICULUM.length; m++) {
    if (idx < CURRICULUM[m].length) return [m, idx];
    idx -= CURRICULUM[m].length;
  }
  return [CURRICULUM.length - 1, CURRICULUM[CURRICULUM.length-1].length - 1];
}

// ‚îÄ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function render(dir = 1) {
  const step = CURRICULUM[currentModule][currentStep];
  const content = document.getElementById('lessonContent');
  const animClass = dir >= 0 ? 'slide-in' : 'slide-in-left';

  content.style.opacity = '0';
  setTimeout(() => {
    content.innerHTML = buildHTML(step);
    content.scrollTop = 0;
    content.className = 'content ' + animClass;
    content.style.opacity = '1';
    updateSidebar();
    updateProgress();
    updateNav();
  }, 180);
}

function buildHTML(step) {
  const fi = flatIndex(currentModule, currentStep);
  const totalSteps = CURRICULUM[currentModule].length;

  // step dots
  let dots = '';
  for (let i = 0; i < totalSteps; i++) {
    let cls = i < currentStep ? 'done' : i === currentStep ? 'active' : '';
    dots += `<div class="step-dot ${cls}"></div>`;
  }

  let html = `<div class="content-inner">
    <div class="step-indicator">${dots}</div>
    <div><span class="phase-stamp">${step.phase}</span></div>
    <div class="lesson-meta">
      <span class="lesson-number">${step.module}</span>
      <span class="lesson-time">‚è± ${step.time}</span>
    </div>
    <h1>${step.title}</h1>
    <p class="subtitle">${step.subtitle}</p>
  `;

  if (step.objective) {
    html += `<div class="objective-card">
      <div class="objective-card-label">üéØ Learning Objective</div>
      <div class="objective-text">${step.objective}</div>
    </div>`;
  }

  // Blocks
  for (const block of step.blocks) {
    html += `<div class="block">`;
    if (block.label) html += `<div class="block-label">${block.label}</div>`;

    if (block.type === 'text') {
      html += `<p class="body-text">${block.body.replace(/\n/g,'<br><br>')}</p>`;
    } else if (block.type === 'callout') {
      html += `<div class="callout"><p class="callout-text">${block.text}</p></div>`;
    } else if (block.type === 'concepts') {
      html += `<div class="concept-grid">`;
      for (const item of block.items) {
        html += `<div class="concept-card"><div class="concept-icon">${item.icon}</div><div class="concept-title">${item.title}</div><div class="concept-desc">${item.desc}</div></div>`;
      }
      html += `</div>`;
    } else if (block.type === 'tiers') {
      html += `<table class="tier-table"><thead><tr><th style="width:140px">Monetization</th><th>What it covers</th></tr></thead><tbody>`;
      for (const row of block.rows) {
        html += `<tr><td><span class="tier-badge ${row.badge.cls}">${row.badge.label}</span></td><td>${row.content}</td></tr>`;
      }
      html += `</tbody></table>`;
    } else if (block.type === 'examples') {
      html += `<ul class="example-list">`;
      for (const item of block.items) {
        html += `<li data-icon="${item.icon}">${item.text}</li>`;
      }
      html += `</ul>`;
    }

    html += `</div>`;
  }

  // Quiz
  if (step.quiz) {
    const alreadyAnswered = answeredSteps.has(flatIndex(currentModule, currentStep));
    html += `<div class="quiz-section">
      <div class="quiz-header"><span class="quiz-badge">‚ú¶ ${currentModule === 2 && currentStep === 2 ? 'Final Challenge' : 'Quick Check'}</span></div>
      <div class="quiz-q">${step.quiz.question}</div>
      <div class="quiz-options" id="quizOpts">`;
    const keys = ['A','B','C','D'];
    step.quiz.options.forEach((opt, i) => {
      html += `<div class="quiz-opt" onclick="selectOpt(this, ${opt.correct}, ${i})" data-correct="${opt.correct}"><span class="opt-key">${keys[i]}</span>${opt.text}</div>`;
    });
    html += `</div><div class="quiz-feedback" id="quizFeedback"></div></div>`;
    if (alreadyAnswered) {
      // Re-show answered state after navigating back
      setTimeout(() => restoreQuizState(step), 50);
    }
  }

  return html + '</div>';
}

function restoreQuizState(step) {
  // just show it as answerable again ‚Äî don't lock it if they've been here
}

// ‚îÄ‚îÄ‚îÄ QUIZ LOGIC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function selectOpt(el, correct, idx) {
  const stepKey = flatIndex(currentModule, currentStep);
  // allow re-attempt if navigated back
  const opts = document.querySelectorAll('.quiz-opt');
  opts.forEach(o => { o.classList.remove('correct','wrong','selected'); o.style.pointerEvents = 'auto'; });
  opts.forEach(o => o.style.pointerEvents = 'none');

  const fb = document.getElementById('quizFeedback');
  const step = CURRICULUM[currentModule][currentStep];

  if (correct) {
    el.classList.add('correct');
    fb.className = 'quiz-feedback show correct-fb';
    fb.innerHTML = step.quiz.correctFeedback;
    answeredSteps.add(stepKey);
  } else {
    el.classList.add('wrong');
    opts.forEach(o => { if (o.dataset.correct === 'true') o.classList.add('correct'); });
    fb.className = 'quiz-feedback show wrong-fb';
    fb.innerHTML = step.quiz.wrongFeedback;
    answeredSteps.add(stepKey);
  }
  updateSidebar();
}

// ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function navigate(dir) {
  direction = dir;
  const flat = flatIndex(currentModule, currentStep);
  const newFlat = flat + dir;

  if (newFlat < 0 || newFlat >= TOTAL_STEPS) {
    if (newFlat >= TOTAL_STEPS) showCompletion();
    return;
  }

  const [nm, ns] = fromFlat(newFlat);
  currentModule = nm;
  currentStep = ns;
  render(dir);
}

function jumpTo(mod, step) {
  const targetFlat = flatIndex(mod, step);
  const currentFlat = flatIndex(currentModule, currentStep);
  direction = targetFlat >= currentFlat ? 1 : -1;
  currentModule = mod;
  currentStep = step;
  render(direction);
}

function showCompletion() {
  const content = document.getElementById('lessonContent');
  content.style.opacity = '0';
  setTimeout(() => {
    content.innerHTML = `<div class="content-inner">
      <div class="completion-card slide-in">
        <div class="completion-icon">üéì</div>
        <div class="completion-title">Course Complete!</div>
        <p class="completion-sub">You've finished all three modules on YouTube's Advertiser-Friendly Content Guidelines ‚Äî covering inappropriate language, violence, and hateful & derogatory content.</p>
        <div class="xp-earned">üèÜ +300 XP Earned</div>
        <div style="margin-top:32px">
          <button class="btn btn-primary" onclick="restartCourse()" style="margin:0 auto; display:inline-flex;">Start Over ‚Üí</button>
        </div>
      </div>
    </div>`;
    content.style.opacity = '1';
    document.getElementById('progressFill').style.width = '100%';
    document.getElementById('masteryBar').style.width = '100%';
    document.getElementById('masteryPct').textContent = '100%';
    document.getElementById('btnNext').disabled = true;
    updateSidebarDots();
  }, 180);
}

function restartCourse() {
  currentModule = 0; currentStep = 0; answeredSteps.clear(); direction = 1;
  document.getElementById('btnNext').disabled = false;
  render(1);
}

// ‚îÄ‚îÄ‚îÄ SIDEBAR & PROGRESS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateSidebar() {
  const currentFlat = flatIndex(currentModule, currentStep);
  let stepNum = 0;
  for (let m = 0; m < CURRICULUM.length; m++) {
    for (let s = 0; s < CURRICULUM[m].length; s++) {
      const fi = flatIndex(m, s);
      const node = document.getElementById(`node-${m}-${s}`);
      const dot = document.getElementById(`dot-${m}-${s}`);
      if (!node) { stepNum++; continue; }
      node.classList.remove('done','active','locked');
      if (fi < currentFlat) {
        node.classList.add('done');
        dot.textContent = '‚úì';
      } else if (fi === currentFlat) {
        node.classList.add('active');
        dot.textContent = stepNum + 1;
      } else {
        node.classList.add('locked');
        dot.textContent = 'üîí';
      }
      stepNum++;
    }
  }
  // Arc fill
  const pct = (currentFlat / (TOTAL_STEPS - 1)) * 100;
  document.getElementById('arcFill').style.height = Math.max(0, pct) + '%';
}

function updateSidebarDots() {
  let stepNum = 0;
  for (let m = 0; m < CURRICULUM.length; m++) {
    for (let s = 0; s < CURRICULUM[m].length; s++) {
      const node = document.getElementById(`node-${m}-${s}`);
      const dot = document.getElementById(`dot-${m}-${s}`);
      if (!node) { stepNum++; continue; }
      node.classList.remove('done','active','locked');
      node.classList.add('done');
      dot.textContent = '‚úì';
      stepNum++;
    }
  }
  document.getElementById('arcFill').style.height = '100%';
}

function updateProgress() {
  const flat = flatIndex(currentModule, currentStep);
  const pct = ((flat + 1) / TOTAL_STEPS) * 100;
  document.getElementById('progressFill').style.width = pct + '%';
  const mastery = Math.round(pct);
  document.getElementById('masteryBar').style.width = mastery + '%';
  document.getElementById('masteryPct').textContent = mastery + '%';
}

function updateNav() {
  const flat = flatIndex(currentModule, currentStep);
  document.getElementById('btnPrev').disabled = flat === 0;
  document.getElementById('btnNext').disabled = false;
  const isLast = flat === TOTAL_STEPS - 1;
  document.getElementById('btnNext').textContent = isLast ? 'Finish Course üéì' : 'Continue ‚Üí';

  const moduleNames = ['Inappropriate Language', 'Violence Policy', 'Hateful Content'];
  const stepNames = ['Overview', 'Deep Dive', 'Quick Check'];
  document.getElementById('navInfo').innerHTML = `<strong>Module ${currentModule + 1} ¬∑ Step ${currentStep + 1} of ${CURRICULUM[currentModule].length}</strong>&nbsp;&nbsp;¬∑&nbsp;&nbsp;${moduleNames[currentModule]}`;
}



// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
render(1);
</script>
</body>
</html>
